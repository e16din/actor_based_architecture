// in progress ..

# Мечта

Меня зовут Александр и я делаю Android-приложения.

У меня есть мечта - сделать разработку мобильных приложений простой, понятной и удобной для всех разработчиков.

Я занимаюсь разработкой уже лет 10 и сделал кучу разных проектов. Я побывал в ролях ученика, разработчика, владельца продукта, ментора, тимлида, что дало мне возможность увидеть разработку с разных сторон.

Все это время я сталкивался с разными препятствиями на своем пути. 

Например простое казалось бы дело - добавить новую фичу к приложению часто превращается в целую эпопею.

И это меня мягко говоря не устраивает.

Я хочу что бы можно было быстро делать прикладные задачи.

Хочу просто взять задачу и сделать ее.

Сейчас же приходится долго выстраивать архитектуру, подгонять ее под новую фичу, втыкать в изучение концепций и фреймворков по обслуживанию этих концепций. А потом еще править баги из-за некорректного понимания этих библиотек, и баги в самих библиотеках, и еще оптимизировать приложение из-за возникшего оверхеда. И еще холиварить на ревью и митингах. 

Все это усложняется, нарастает и зацикливается, превращается в ежедневную рутину.

Я задавался вопросами - почему так происходит, должно ли это быть так сложно, как сделать иначе? Я разбирался, искал ответы, эксперементировал. 

Теперь я готов кое-что поменять в лучшую сторону для всех желающих, для тех кто верит что должно быть иначе чем сейчас и кому срезонирует то во что верю я:

----------------------

## Про людей:

Я верю что должен быть способ легко делать качественные приложения даже если ты совсем начинающий разработчик.

Я верю что Clean Architecture, SOLID, MVVM, DI, RX и другие страшные аббревиатуры должны уйти из списка требований к программисту, в пользу прикладных задач, бизнес-логики и API платформы.

Я верю что можно привести проект к такому состоянию, что любой человек разберется в его логике за неделю, а первую задачу сделает в первый же день.


## Про время:

Я верю что можно настроить процес разработки так, что разработчик получив задачу сможет быстро приступить к ее реализации, и не тратить много времени на архитектуру и подгонку разных частей.

Я верю что качественное приложение можно написать очень быстро - простое за пару дней, среднее за пару недель, а сложное за пару месяцев.

Я верю что код проекта можно писать быстро и при этом качественно.


## Про архитектуру:

Я верю что можно сильно упростить архитектуру и конструкцию современных приложений.

Я верю что чистая архитектура должна быть проста для понимания и легка в применении.

Я верю что можно писать приложения без кучи концепций, костылей в виде монструозных фреймворков и библиотек.


## Про тестирование:

Я верю что можно выполнять задачи так, что их не будут возвращать каждый раз на доработку деталей, даже если менеджер что-то упустил в формулировке.

Я верю что разработчик может сразу видеть все связи ключевых объектов и продумывать все детали еще на старте выполнения задачи, следовательно может все это проверить на финише.

Я верю что авто-тесты не должны быть проблемой и можно сразу написать код пригодный к покрытию тестами. Без необходимости перестраивать проект специально под тесты.


## Про поддержку:

Я верю что можно писать легковесный код, который быстро компилируется и мало весит.

Я верю что можно сократить код современного прод-проекта на порядок, при этом качество кода возрастет, а поддерживать его будет проще.

Я верю что можно сразу написать код который легко поддерживать и не надо переписывать с ростом приложения.


## Про жизнь

Я верю что отбросив лишнее мы высвободим время для действительно важного - для жизни. Для улучшения качества своей жизни и жизни окружающих.

Я верю что с ускорением процесса разработки, придут другие, новые задачи, еще интереснее и еще полезнее.

Я верю что каждый из нас является проводником тех перемен которые он бы хотел видеть в жизни.

----------------------

# Путь

Предлагаю такой путь - встать на плечи гигантов и устремиться еще выше, использовать уже доступные нам ООП, ФП, Clean Architecture, кое-что отбросить, что-то пересмотреть. Все это поможет  воплотить мечты в реальность.

Призываю энтузиастов подключиться к этому процессу, возможно развивать то решение что предложу я, Акторную Архитектуру, а может быть сделать что-то еще. 

Присоединяйтесь друзья, сделаем разработку великой снова!


# Акторная Архитектура

Есть пара очевидных закономерностей:
- чем больше кода, тем больше с ним проблем
- чем непонятнее код, тем больше с ним проблем

И вопрос на который надо ответить чтобы найти лучшее решение
- как писать минимум кода который при этом легко понимать?

Так случилось что я увлекся ТРИЗ и теорией систем, а моя жена в это время занималась философией субъект-объектных отношений.

Все это помогло мне сформулировать простое и легковесное, в сравнении с другими подходами (MVVM, Clean Architecture), решение.

Я назвал этот подход - Акторная Архитектура.

Суть подхода такова - мы описываем в стиле ООП все системы которые взаимодействуют между собой в рамках работы приложения - пользователь, сервер, устройство, приложение, экран приложения. В результате чего код обретает хорошую структуру и из кода уходит много лишнего.

Мы рассматриваем все действующие лица, субъекты которые как мы задумываем участвуют в процессе работы приложения. Получается что наше приложение это актор(действующее лицо), который взаимодействует с другими акторами.

Я сделал простую игру в съедобное-несъедобное под Android на примере которой хочу показать как это работает:

todo: - Схема с картинками, вставить куски кода, для акторов вставить картинки

todo: - Ссылка на исходники

* Кто-то подумал что акторы будут становиться огромными с ростом приложения - верное замечание.

Поэтому в коде мы подразумеваем что есть реальная сущность актора с которой общается наше приложение. Общение происходит через интерфейс агентов, и эти агенты содержат только нужный на конкретном экране функционал. 

Можно воспринимать агент как API актора на конкретном экране. И каждая функция такого агента - это интерактор/юзкейс (или ручка API).

Получается в каждом Fragment/Activity будет свой набор агентов(UserAgent, ServerAgent, AppAgent), со своим уникальным функционалом. Представьте что один монолит мы разбили по кусочкам и перенесли эти куски непосредственно в места использования.

* Наверняка вы так же как и я сталкивались со свалкой кода, когда весь код помещался в одной Activity. Такой код громоздкий, запутанный и малопонятный.

Агенты кроме того что позволяют не писать God-акторы, еще и структурируют код понятным образом. Каждый агент является по существу набором интеракторов/юзкейсов для одного из акторов, что очень удобно.

* Когда будете смотреть код не пугайтесь, классы агентов прибиты гвоздями - это внутренние классы экрана Fragment/Activity и не предполагают использования где-то еще. Используются прежде всего для создания удобной структуры.

* Некоторые задались вопросом, а как же это дело тестировать если классы встроенные? Тестировать можно как обычно с помощью моков, в проекте добавил пример с авто-тестами.

* Посмотрите на состав билиотек - нет DI-фреймворка (Dagger/Hilt/Koin), нет фреймворка для передачи данных (RX/Flow/LiveData), не нужен фреймворк для разделения кода (ViewModel/Presenter).

* Обратите внимание что вся бизнес-логика содержится в функции main(), что наглядно и информативно.

* Обратите внимание на чистоту класса App который тоже имеет тенденцию разрастаться с ростом проекта. В акторной архитектуре это исключено, так-как все выносится как можно ближе к месту использования (за эту мудрость я благодарен С.С.Михалковичу, пригодилось многократно)

# Киллер-фича

Основное нововведение здесь - это простая структура, она творит волшебство. 

Функции в блоках UserAgent, ServerAgent, AppAgent можно было написать и в основном классе фрагмента, но тогда бы получилась мешанина с которой сложно работать, такая структура неудобна для восприятия. 

Нам надо как раз наоборот - повысить удобство восприятия, поэтому мы группируем функции в блоки. И на моем опыте понятнее всего получается если группировать их по принадлежности к актору - таким образом получается минимум архитектурных изысканий, которые дают нам максимум удобства. 

Я вижу в этом много разных плюсов в сравнении с другими подходами, но нет смысла их все описывать здесь, ведь это лишь следствия простой структуры. 

Тут даже нечего рекламировать кроме хорошего соотношения качеств простота-эффективность. 

По этим качествам такая архитектура словно автомат Калашникова в мире оружия.

# Благодарность

Среди тех с кем я общался, у кого я учился, с кем работал, очень много мудрых, отзывчивых и инициативных людей, выражаю вам свою благодарность и постараюсь благодарить почаще, вы этого достойны :)

Отдельная благодарность ребятам из Kotlin Rostov User Group чьи вопросы и замечания помогли доработать статью и подход.

# P.S.

Друзья говорят что можно сделать сравнение с проектом на традиционном подходе и проектом на акторной архитектуре - звучит разумно. 

Готов ли кто-нибудь сделать клон проекта в стиле Clean Architecture + MVVM, чтобы можно было провести объективное сравнение?
